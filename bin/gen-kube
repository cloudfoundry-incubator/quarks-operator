#!/usr/bin/env bash

set -o errexit
set -o nounset
set -o pipefail

GO111MODULE=${GO111MODULE:-on} #Always on, so it works also inside GOPATH
GIT_ROOT=${GIT_ROOT:-$(git rev-parse --show-toplevel)}
PROJECT="quarks-operator"
# The groups and their versions in the format "groupA:v1,v2 groupB:v1 groupC:v2"
GROUP_VERSIONS="boshdeployment:v1alpha1 quarksstatefulset:v1alpha1 quarkssecret:v1alpha1"
QUARKS_UTILS=${QUARKS_UTILS:-../quarks-utils}

cd "$GIT_ROOT"

if [ -z ${QUARKS_UTILS+x} ] || [ ! -d "$QUARKS_UTILS" ]; then
  echo 'Please set QUARKS_UTILS to the location of code.cloudfoundry.org/quarks-utils'
  echo 'git clone https://github.com/cloudfoundry-incubator/quarks-utils.git ../quarks-utils'
  echo
  exit 1
fi

export GIT_ROOT
export PROJECT
export GROUP_VERSIONS
$QUARKS_UTILS/bin/gen-kube
